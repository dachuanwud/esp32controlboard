# ESP32控制板 Web上位机用户使用说明

## 目录

1. 系统概述
2. 快速开始
3. 功能模块详解
4. 常见操作指南
5. 故障排除
6. 附录

---

## 一、系统概述

### 1.1 什么是Web上位机？

Web上位机是一个基于浏览器的设备管理界面，用于远程监控和控制ESP32控制板。通过Web界面，您可以：

（1）实时查看设备状态和运行数据

（2）管理多个ESP32设备

（3）配置WiFi网络连接

（4）进行OTA固件更新

（5）管理云服务器注册的设备

（6）发送控制指令到设备

### 1.2 系统要求

表1-1 系统要求

| 项目 | 要求 |
|------|------|
| 浏览器 | Chrome 90+、Firefox 88+、Edge 90+、Safari 14+ |
| 网络 | 与ESP32设备在同一局域网，或通过云服务器访问 |
| 设备 | ESP32控制板已启动并连接到网络 |

### 1.3 访问方式

（1）本地访问：在浏览器中输入ESP32设备的IP地址（例如：http://192.168.1.100）

（2）云服务器访问：通过云服务器提供的Web界面访问

---

## 二、快速开始

### 2.1 第一步：添加设备

首次使用需要添加ESP32设备，操作步骤如下：

步骤1：点击导航栏中的"设备选择器"（显示"未选择设备"）

步骤2：选择"设备管理"

步骤3：在设备管理对话框中，选择"手动添加"标签页

步骤4：填写设备信息
   - 设备名称：为设备起一个便于识别的名称（例如：ESP32-001）
   - IP地址：输入ESP32设备的IP地址（例如：192.168.1.100）

步骤5：点击"添加设备"按钮

步骤6：系统会自动测试连接，成功后设备将被添加到列表中

### 2.2 第二步：选择设备

添加设备后，需要选择要操作的设备：

步骤1：点击导航栏中的"设备选择器"

步骤2：从下拉菜单中选择要操作的设备

步骤3：设备名称旁边会显示在线状态指示器（绿色表示在线，灰色表示离线）

### 2.3 第三步：查看设备信息

选择设备后，您可以：

（1）点击"设备信息"查看设备详细信息

（2）点击"实时状态"查看实时运行数据

（3）点击"Wi-Fi设置"配置网络连接

---

## 三、功能模块详解

### 3.1 设备信息

**功能说明**：显示ESP32控制板的基本信息和系统资源状态。

#### 3.1.1 基本信息卡片

表3-1 基本信息说明

| 信息项 | 说明 |
|--------|------|
| 设备名称 | ESP32设备的自定义名称 |
| 固件版本 | 当前运行的固件版本号 |
| 硬件版本 | 硬件版本标识 |
| 芯片型号 | ESP32芯片型号（如ESP32-WROOM-32） |
| MAC地址 | 设备的唯一MAC地址 |

#### 3.1.2 系统资源卡片

表3-2 系统资源说明

| 资源项 | 说明 |
|--------|------|
| Flash存储 | 总Flash存储容量 |
| 内存状态 | 可用内存和内存使用率（带进度条） |
| 运行时间 | 设备自启动以来的运行时间（实时更新） |

#### 3.1.3 操作说明

（1）刷新数据：手动刷新设备信息（系统每30秒自动刷新一次）

（2）运行时间实时更新：运行时间每秒自动更新，每5分钟同步一次服务器时间

---

### 3.2 实时状态

**功能说明**：实时监控设备的运行状态和数据。

#### 3.2.1 连接状态卡片

显示三个关键连接的状态：

（1）SBUS遥控：SBUS遥控器连接状态

（2）CAN总线：CAN总线连接状态

（3）Wi-Fi网络：WiFi网络连接状态（包含IP地址和信号强度）

#### 3.2.2 电机状态卡片

显示左右两个电机的实时速度：

（1）左电机速度：显示速度百分比（-100%到+100%）

（2）右电机速度：显示速度百分比（-100%到+100%）

（3）速度条：可视化显示电机速度

#### 3.2.3 SBUS通道数据卡片

显示SBUS遥控器的16个通道数据：

（1）通道1-8：默认显示前8个通道

（2）通道9-16：点击"显示更多通道"展开

（3）通道值：显示原始值（1050-1950）和百分比

（4）进度条：可视化显示通道值

#### 3.2.4 时间信息卡片

（1）最后SBUS更新：最后一次收到SBUS信号的时间

（2）最后命令更新：最后一次收到控制命令的时间

#### 3.2.5 操作说明

（1）自动刷新开关：开启/关闭自动刷新（默认开启，每2秒刷新一次）

（2）手动刷新：立即刷新一次状态数据

---

### 3.3 Wi-Fi设置

**功能说明**：配置和管理ESP32设备的WiFi网络连接。

#### 3.3.1 当前状态卡片

显示当前WiFi连接状态：

表3-3 WiFi连接状态说明

| 信息项 | 说明 |
|--------|------|
| 连接状态 | 已连接/连接中/未连接/连接失败 |
| IP地址 | 当前分配的IP地址（仅连接时显示） |
| 信号强度 | WiFi信号强度（dBm）和等级（优秀/良好/一般/较差） |
| 连接时间 | 连接建立的时间 |
| 重试次数 | 连接失败后的重试次数 |

#### 3.3.2 连接到Wi-Fi卡片

手动连接WiFi网络的操作步骤：

步骤1：在"网络名称（SSID）"输入框中输入要连接的WiFi网络名称

步骤2：在"密码"输入框中输入WiFi密码（如果网络需要密码）

步骤3：点击"连接"按钮

步骤4：等待连接完成（通常需要5-10秒）

#### 3.3.3 可用网络卡片

扫描并显示附近的WiFi网络：

（1）扫描网络：点击"扫描网络"按钮扫描可用网络

（2）网络列表：显示扫描到的网络，包括：
   - 网络名称（SSID）
   - 加密状态（锁图标表示需要密码）
   - 信号强度（dBm）
   - 认证模式

（3）快速选择：点击列表中的网络名称，自动填入连接表单

#### 3.3.4 操作说明

（1）刷新状态：手动刷新WiFi连接状态（系统每10秒自动刷新）

（2）扫描网络：扫描附近的WiFi网络（可能需要几秒钟）

---

### 3.4 设备管理

**功能说明**：管理本地存储的ESP32设备列表。

#### 3.4.1 手动添加设备

**适用场景**：已知设备的IP地址

**操作步骤**：

步骤1：在设备管理对话框中，选择"手动添加"标签页

步骤2：填写设备信息
   - 设备名称：自定义名称（例如：ESP32-001）
   - IP地址：设备的IP地址（例如：192.168.1.100）

步骤3：点击"添加设备"按钮

步骤4：系统会自动测试连接
   - 连接成功：设备被添加到列表
   - 连接失败：显示错误信息，请检查IP地址和网络连接

#### 3.4.2 设备发现

**适用场景**：不知道设备的IP地址，需要自动发现

**快速发现操作步骤**：

步骤1：选择"设备发现"标签页

步骤2：点击"快速发现"按钮

步骤3：系统会自动扫描常见的IP地址范围

步骤4：扫描完成后，发现的设备会显示在列表中

步骤5：点击设备旁边的"添加"按钮添加到设备列表

**全网段扫描操作步骤**：

步骤1：在"IP网段"输入框中输入网段（例如：192.168.1）

步骤2：点击"全网段扫描"按钮

步骤3：系统会扫描该网段下的所有IP地址（1-254）

步骤4：扫描过程会显示进度条

步骤5：扫描完成后，发现的设备会显示在列表中

**注意事项**：

（1）扫描可能需要较长时间（全网段扫描可能需要1-2分钟）

（2）确保ESP32设备已启动并连接到网络

（3）某些网络环境可能阻止扫描功能

#### 3.4.3 设备管理操作

**查看已添加的设备**：

步骤1：选择"设备管理"标签页

步骤2：查看设备列表，每个设备显示：
   - 设备名称
   - 在线/离线状态
   - IP地址
   - 最后连接时间

**编辑设备**：

步骤1：点击设备旁边的"编辑"按钮

步骤2：修改设备名称或IP地址

步骤3：点击"保存"按钮

步骤4：如果IP地址改变，系统会自动测试新连接

**测试连接**：

步骤1：点击设备旁边的"测试"按钮

步骤2：系统会测试与设备的连接

步骤3：测试结果会更新设备状态

**删除设备**：

步骤1：点击设备旁边的"删除"按钮

步骤2：确认删除操作

步骤3：设备将从列表中移除

---

### 3.5 云设备管理

**功能说明**：管理注册到云服务器的ESP32设备。

#### 3.5.1 设备列表

显示所有注册到云服务器的设备：

表3-4 云设备信息说明

| 信息项 | 说明 |
|--------|------|
| 设备名称 | 设备在云服务器中的名称 |
| 设备ID | 设备的唯一标识符 |
| IP地址 | 设备的本地IP地址 |
| 状态 | 在线/离线状态 |
| 注册时间 | 设备注册到云服务器的时间 |
| 最后活跃 | 设备最后一次上报状态的时间 |

#### 3.5.2 选择设备

步骤1：点击设备列表中的"选择"按钮

步骤2：选中的设备会显示在"当前选中设备"卡片中

步骤3：选中设备后，可以执行以下操作：
   - 发送指令
   - 测试连接
   - 删除设备

#### 3.5.3 发送指令

向选中的设备发送控制指令：

步骤1：点击"发送指令"按钮

步骤2：在弹出对话框中填写：
   - 指令名称：指令类型（例如：led_control、motor_speed、restart）
   - 指令数据：JSON格式的数据（例如：{"pin": 2, "state": true}）

步骤3：点击"发送指令"按钮

步骤4：系统会显示发送结果

**指令数据格式说明**：

（1）必须是有效的JSON格式

（2）如果不需要数据，可以输入 {}

（3）示例格式：
   - {"pin": 2, "state": true}
   - {"speed": 50, "direction": "forward"}
   - {"action": "restart"}

#### 3.5.4 测试连接

测试与设备的网络连接：

步骤1：点击设备旁边的"测试"按钮

步骤2：系统会测试与设备的连接

步骤3：测试结果会显示在消息提示中

#### 3.5.5 删除设备

从云服务器中删除设备：

步骤1：点击设备旁边的"删除"按钮

步骤2：在确认对话框中，输入设备名称以确认删除

步骤3：点击"确认删除"按钮

步骤4：设备将从云服务器中永久删除

**警告**：删除操作不可撤销，会删除所有相关的状态历史数据和指令记录。

#### 3.5.6 操作说明

（1）刷新列表：手动刷新设备列表（系统每30秒自动刷新）

（2）自动刷新：设备列表每30秒自动更新一次

---

### 3.6 云设备状态

**功能说明**：实时监控云服务器中注册的设备状态。

#### 3.6.1 设备选择器

步骤1：页面顶部显示所有注册的设备

步骤2：点击设备卡片选择要监控的设备

步骤3：选中的设备会高亮显示，并显示"当前选中"标识

#### 3.6.2 状态监控

选择设备后，显示以下信息：

**连接状态卡片**：

（1）SBUS遥控连接状态

（2）CAN总线连接状态

（3）WiFi网络连接状态（包含IP地址和信号强度）

**系统资源卡片**：

（1）可用内存（带进度条）

（2）运行时间

（3）任务数量

**SBUS通道数据卡片**（仅当SBUS连接时显示）：

（1）显示前8个通道的数据

（2）每个通道显示原始值和进度条

**CAN总线状态卡片**（仅当CAN连接时显示）：

（1）CAN发送计数

（2）CAN接收计数

#### 3.6.3 操作说明

（1）自动刷新开关：开启/关闭自动刷新（默认开启，每5秒刷新一次）

（2）手动刷新：立即刷新一次设备状态

---

### 3.7 OTA管理

**功能说明**：上传固件文件并部署到ESP32设备。

#### 3.7.1 固件管理

**查看固件列表**：

固件列表显示所有已上传的固件文件：

表3-5 固件列表说明

| 列 | 说明 |
|----|------|
| 版本 | 固件版本号 |
| 文件名 | 原始文件名 |
| 设备类型 | 支持的设备类型（ESP32、ESP32-S2等） |
| 大小 | 固件文件大小 |
| 上传时间 | 固件上传的时间 |
| 状态 | 固件状态（可用/等待中等） |

**上传固件操作步骤**：

步骤1：点击"上传固件"按钮

步骤2：在弹出对话框中填写：
   - 固件文件：选择.bin格式的固件文件
   - 版本号：输入版本号（例如：1.0.0）
   - 设备类型：选择设备类型（默认ESP32）
   - 描述：输入固件更新说明（可选）

步骤3：点击"上传固件"按钮

步骤4：等待上传完成（显示上传进度条）

**部署固件操作步骤**：

步骤1：在固件列表中，点击要部署的固件旁边的"部署"按钮

步骤2：在弹出对话框中：
   - 部署名称：输入部署任务的名称（可选，系统会自动生成）
   - 选择目标设备：勾选要更新的设备（可以多选）
   - 点击"全选"快速选择所有设备

步骤3：点击"开始部署"按钮

步骤4：部署任务会显示在部署历史中

**删除固件操作步骤**：

步骤1：点击固件旁边的"删除"按钮

步骤2：确认删除操作

步骤3：固件文件将从服务器中删除

#### 3.7.2 部署历史

显示所有固件部署任务的记录：

表3-6 部署历史说明

| 列 | 说明 |
|----|------|
| 部署名称 | 部署任务的名称 |
| 固件版本 | 部署的固件版本 |
| 状态 | 部署状态（等待中/进行中/已完成/失败/部分成功） |
| 进度 | 部署进度百分比（带进度条） |
| 设备数量 | 已完成/总数/失败数 |
| 时间信息 | 创建时间、开始时间 |
| 耗时 | 部署任务的总耗时 |

**状态说明**：

（1）等待中：部署任务已创建，等待执行

（2）进行中：正在部署中（显示旋转图标）

（3）已完成：所有设备更新成功

（4）失败：所有设备更新失败

（5）部分成功：部分设备更新成功，部分失败

#### 3.7.3 操作说明

（1）自动刷新：部署历史每3秒自动刷新一次状态

（2）基础数据刷新：固件列表和设备列表每10秒刷新一次

---

## 四、常见操作指南

### 4.1 首次使用流程

**步骤1：添加设备**
   - 如果知道IP地址：使用"手动添加"
   - 如果不知道IP地址：使用"设备发现"

**步骤2：选择设备**
   - 从导航栏的设备选择器中选择设备

**步骤3：查看设备信息**
   - 访问"设备信息"页面查看基本信息
   - 访问"实时状态"页面查看运行数据

**步骤4：配置WiFi**（如需要）
   - 访问"Wi-Fi设置"页面
   - 扫描网络或手动输入网络信息
   - 连接WiFi网络

### 4.2 固件更新流程

**步骤1：准备固件文件**
   - 确保固件文件是.bin格式
   - 记录固件版本号

**步骤2：上传固件**
   - 访问"OTA管理"页面
   - 点击"上传固件"按钮
   - 填写固件信息并上传

**步骤3：部署固件**
   - 在固件列表中选择要部署的固件
   - 点击"部署"按钮
   - 选择目标设备
   - 开始部署

**步骤4：监控部署进度**
   - 在"部署历史"中查看部署进度
   - 等待部署完成

### 4.3 多设备管理

**步骤1：添加多个设备**
   - 使用设备管理功能添加多个设备
   - 为每个设备设置不同的名称便于识别

**步骤2：切换设备**
   - 使用导航栏的设备选择器快速切换设备
   - 每个设备的状态会独立显示

**步骤3：云设备管理**
   - 使用"云设备管理"页面管理注册到云服务器的设备
   - 可以同时管理多个云设备

### 4.4 网络配置

**步骤1：查看当前网络**
   - 访问"Wi-Fi设置"页面
   - 查看"当前状态"卡片

**步骤2：连接新网络**
   - 点击"扫描网络"查找可用网络
   - 或手动输入网络信息
   - 点击"连接"按钮

**步骤3：网络故障排除**
   - 检查设备是否在线
   - 检查IP地址是否正确
   - 尝试刷新状态或重新连接

---

## 五、故障排除

### 5.1 常见问题

#### 5.1.1 无法添加设备

**问题描述**：添加设备时提示"无法连接到设备"

**解决方案**：

（1）检查ESP32设备是否已启动

（2）检查设备IP地址是否正确

（3）确保电脑和设备在同一局域网

（4）检查防火墙设置，确保允许HTTP连接

（5）尝试ping设备的IP地址测试网络连通性

#### 5.1.2 设备显示离线

**问题描述**：设备列表中设备状态显示为"离线"

**解决方案**：

（1）点击"测试"按钮测试连接

（2）检查设备是否正常运行

（3）检查网络连接是否正常

（4）尝试刷新设备列表

#### 5.1.3 无法扫描WiFi网络

**问题描述**：点击"扫描网络"后没有发现任何网络

**解决方案**：

（1）确保设备已连接到网络

（2）等待扫描完成（可能需要几秒钟）

（3）尝试手动输入网络信息

（4）检查设备WiFi功能是否正常

#### 5.1.4 WiFi连接失败

**问题描述**：输入WiFi信息后无法连接

**解决方案**：

（1）检查网络名称（SSID）是否正确

（2）检查密码是否正确

（3）确保网络信号强度足够

（4）检查网络是否需要特殊认证

（5）查看"重试次数"了解连接失败原因

#### 5.1.5 固件上传失败

**问题描述**：上传固件时提示失败

**解决方案**：

（1）检查固件文件格式是否为.bin

（2）检查固件文件大小是否超过限制

（3）检查网络连接是否稳定

（4）尝试重新上传

#### 5.1.6 部署固件失败

**问题描述**：部署固件时部分或全部设备失败

**解决方案**：

（1）检查目标设备是否在线

（2）检查设备是否有足够的存储空间

（3）检查网络连接是否稳定

（4）查看部署历史中的错误信息

（5）尝试单独部署到单个设备

#### 5.1.7 页面无法加载

**问题描述**：打开Web界面后页面无法正常显示

**解决方案**：

（1）检查浏览器版本是否支持

（2）清除浏览器缓存

（3）尝试使用其他浏览器

（4）检查网络连接

（5）检查设备是否正常运行

#### 5.1.8 实时状态不更新

**问题描述**：实时状态页面数据不更新

**解决方案**：

（1）检查"自动刷新"开关是否开启

（2）点击"手动刷新"按钮测试

（3）检查设备是否在线

（4）检查网络连接是否正常

### 5.2 错误代码说明

表5-1 错误代码说明

| 错误信息 | 可能原因 | 解决方案 |
|---------|---------|---------|
| 无法连接到设备 | 网络不通或设备离线 | 检查网络和设备状态 |
| 设备未响应 | 设备繁忙或故障 | 等待后重试或重启设备 |
| 固件格式错误 | 文件格式不正确 | 确保使用.bin格式文件 |
| 存储空间不足 | Flash空间不够 | 删除旧固件或使用更大的分区 |
| 网络超时 | 网络连接不稳定 | 检查网络连接后重试 |

---

## 六、附录

### 6.1 快捷键说明

表6-1 快捷键说明

| 操作 | 快捷键 | 说明 |
|------|--------|------|
| 刷新页面 | F5 | 刷新当前页面 |
| 强制刷新 | Ctrl+F5 | 清除缓存后刷新 |
| 打开开发者工具 | F12 | 查看页面调试信息 |

### 6.2 浏览器兼容性

表6-2 浏览器兼容性说明

| 浏览器 | 最低版本 | 推荐版本 | 说明 |
|--------|---------|---------|------|
| Chrome | 90 | 最新版 | 推荐使用 |
| Firefox | 88 | 最新版 | 完全支持 |
| Edge | 90 | 最新版 | 完全支持 |
| Safari | 14 | 最新版 | 完全支持 |

### 6.3 网络要求

（1）本地访问：设备与电脑需在同一局域网

（2）云服务器访问：需要稳定的互联网连接

（3）带宽要求：建议至少1Mbps（用于实时状态更新）

### 6.4 设备要求

（1）ESP32控制板：已烧录固件并启动

（2）网络连接：设备已连接到WiFi或以太网

（3）固件版本：建议使用最新版本固件

### 6.5 技术支持

如遇到问题，可以：

（1）查看日志：在浏览器开发者工具中查看错误信息

（2）检查设备状态：确保设备正常运行

（3）联系支持：通过项目GitHub Issues提交问题

### 6.6 更新日志

查看项目更新日志了解最新功能和修复：

（1）GitHub Releases：https://github.com/dachuanwud/esp32controlboard/releases

（2）项目文档：查看项目README文件

---

## 七、总结

Web上位机提供了完整的ESP32控制板管理功能，包括：

（1）设备管理和监控

（2）实时状态查看

（3）WiFi网络配置

（4）OTA固件更新

（5）云设备管理

（6）远程控制指令

通过本使用说明，您应该能够熟练使用Web上位机的各项功能。如有任何问题，请参考故障排除部分或联系技术支持。

---

文档版本：v1.0.0  
最后更新：2024-12-19  
适用固件版本：v2.0.0+

